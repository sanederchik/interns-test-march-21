# interns-test-march-21

## Задачи

1. Есть сайт https://yandex.ru/covid19/stat. Нужно написать парсер, который бы получал данные о заражениях, смертях и тестах в динамике по всем странам на графике и формировал бы CSV файл на каждый момент начала запуска парсера.

![image](https://user-images.githubusercontent.com/30187683/111162102-e2bf7780-85ac-11eb-9676-886302013f42.png)

2. Нужно написать SQL-выражение, которое бы складывало полученные из п.1 данные в следующую таблицу:
Название поля	Тип данных	Описание	Ключ?
country_name	string	Название страны (Бразилия, Россия и т.д.)	PK
data_date	date	Дата на графике	PK
cases_cnt	numeric	Кол-во заражений на млн человек	
deaths_cnt	numeric	Кол-во смертей на млн человек	
tests_cnt	numeric	Кол-во тестов на млн человек	
version_dt	datetime	Дата и время начала парсинга данных	PK

![image](https://user-images.githubusercontent.com/30187683/111163785-780f3b80-85ae-11eb-879c-b272891161fd.png)

**Название таблицы**: ydata_main_data
**Первичный ключ**: составной, на основе полей PK
**Индексы**: version_dt, обычный

3. Из полученной таблицы `ydata_main_data` нужно составить таблицу `ydata_detail_main_data`, дедублицировав записи на основе поля `version_dt` (брать самое последнее). Нужно показать 2 способа, как это сделать.

4. Основывясь на данных таблицы `ydata_detail_main_data` составить SQL-запрос, который позволит посчитать следующие метрики на каждую из дат `data_date`:
4.1. Те страны и значение метрики "Смерти / Ср.Заражения за 14 дат назад", где показатель выше `X%` (выбрать самостоятельно), отсортировав страны по убыванию данной метрики.
4.2. Те страны и значение метрики "Заражения / Тесты", отфильтровав только те страны, где показатель метрики выше `X%` (выбрать самостоятельно) и ТОП-5 самых маленьких значений "Смерти / Ср. Заражения". Полученный датасет отсортировать по убыванию метрики "Заражения / Тесты".

5. Весь код положить в форк данного проекта.
